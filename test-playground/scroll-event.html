<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="../style.css" />
  </head>
  <body>
    <div class="todo-container">
      <div class="todo-item completed" style="position: relative">
        <div class="icon-container"><div class="finish-icon"></div></div>
        <p>
          Lorem ipsum dolor sit amet consectetur adipisicing elit.
          Distinctioipsam ex voluptatum numquam sit. Nihil odio sapiente dolor
          error quasi dolorem, totam assumenda laudantium? Non modi eius
          recusandae assumenda beatae.
        </p>
        <div
          class="btn-group"
          style="
            transition: 0.4s;
            display: flex;
            border-radius: 5px;
            position: absolute;
            top: 0px;
            right: 0px;
            width: 0px;
            height: 100%;

            justify-content: center;
            align-items: center;
            background-color: red;
          "
        >
          <span class="material-icons" style="opacity: 0; transition: 0.2s"
            >delete</span
          >
        </div>
      </div>
    </div>

    <script>
      const div = document.querySelector(".todo-container");
      const btn = document.querySelector(".btn-group");
      const btnIcon = btn.querySelector("span");
      const content = document.querySelector(".todo-item");

      var startX;
      const maxWidth = "80";

      div.addEventListener("touchstart", (event) => {
        event.stopPropagation();
        const id = event.target.dataset.id;
        const touchStart = event.changedTouches[0];
        startX = touchStart.clientX;

        console.log([`id:${id}\n`, `startX:${startX}`].join(" "));
      });

      div.addEventListener("touchmove", (event) => {
        const id = event.target.dataset.id;

        let diffX = Math.max(
          0,
          Math.min(startX - event.changedTouches[0].clientX, maxWidth)
        );

        content.style.left = `${-diffX}px`;
        if (diffX > maxWidth * 0.618) {
          btnIcon.style.opacity = "1";
        } else {
          btnIcon.style.opacity = "0";
        }

        btn.style.right = `${-diffX}px`;
        btn.style.width = `${diffX}px`;

        event.stopPropagation();
      });

      div.addEventListener("touchend", (event) => {
        const id = event.target.dataset.id;
        let diffX = Math.max(
          0,
          Math.min(startX - event.changedTouches[0].clientX, maxWidth)
        );
        if (diffX > maxWidth * 0.618) {
          diffX = maxWidth;
          btnIcon.style.opacity = "1";
        } else {
          diffX = 0;
          btnIcon.style.opacity = "0";
        }

        content.style.left = `${-diffX}px`;
        btn.style.right = `${-diffX}px`;
        btn.style.width = `${diffX}px`;
        event.stopPropagation();

        console.log([`id:${id}\n`, `diffX:${diffX}`].join(" "));
      });
    </script>
  </body>
</html>
